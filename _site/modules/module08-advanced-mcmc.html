<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Module 8: Advanced MCMC Methods – Bayesian Statistics and Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b337f537912f5ab074b938eebad4c5d7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Bayesian Statistics and Inference</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-modules" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Modules</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-modules">    
        <li>
    <a class="dropdown-item" href="../modules/module01-foundations.html">
 <span class="dropdown-text">1. Foundations of Bayesian Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module02-conjugate.html">
 <span class="dropdown-text">2. Conjugate Models and Exact Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module03-regression.html">
 <span class="dropdown-text">3. Bayesian Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module04-glm.html">
 <span class="dropdown-text">4. Bayesian GLMs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module05-mcmc-theory.html">
 <span class="dropdown-text">5. MCMC Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module06-mh.html">
 <span class="dropdown-text">6. Metropolis-Hastings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module07-gibbs.html">
 <span class="dropdown-text">7. Gibbs Sampling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module08-advanced-mcmc.html">
 <span class="dropdown-text">8. Advanced MCMC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module09-vi.html">
 <span class="dropdown-text">9. Variational Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module10-gp.html">
 <span class="dropdown-text">10. Gaussian Processes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module11-optimization.html">
 <span class="dropdown-text">11. Optimization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module12-asymptotics.html">
 <span class="dropdown-text">12. Asymptotics and Consistency</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../modules/module13-checking.html">
 <span class="dropdown-text">13. Model Checking and Criticism</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modules/module01-foundations.html">Modules</a></li><li class="breadcrumb-item"><a href="../modules/module08-advanced-mcmc.html">Module 8: Advanced MCMC Methods</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Statistics and Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module01-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 1: Foundations of Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module02-conjugate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 2: Conjugate Models and Exact Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module03-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 3: Bayesian Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module04-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 4: Bayesian Generalized Linear Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module05-mcmc-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 5: Markov Chain Monte Carlo (MCMC) Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module06-mh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 6: Metropolis–Hastings Algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module07-gibbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 7: Gibbs Sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module08-advanced-mcmc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Module 8: Advanced MCMC Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module09-vi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 9: Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module10-gp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 10: Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module11-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 11: Optimization in Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module12-asymptotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 12: Asymptotic Theory and Consistency</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/module13-checking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 13: Model Checking and Criticism</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#module-8-advanced-mcmc-methods" id="toc-module-8-advanced-mcmc-methods" class="nav-link active" data-scroll-target="#module-8-advanced-mcmc-methods">Module 8: Advanced MCMC Methods</a>
  <ul class="collapse">
  <li><a href="#hamiltonian-monte-carlo-hmc" id="toc-hamiltonian-monte-carlo-hmc" class="nav-link" data-scroll-target="#hamiltonian-monte-carlo-hmc">1. Hamiltonian Monte Carlo (HMC)</a>
  <ul class="collapse">
  <li><a href="#extended-state-space-and-hamiltonian-dynamics" id="toc-extended-state-space-and-hamiltonian-dynamics" class="nav-link" data-scroll-target="#extended-state-space-and-hamiltonian-dynamics">1.1 Extended State Space and Hamiltonian Dynamics</a></li>
  <li><a href="#prop-hmc-volume-energy" id="toc-prop-hmc-volume-energy" class="nav-link" data-scroll-target="#prop-hmc-volume-energy">Proposition 8.1 (Volume Preservation and Energy Conservation)</a></li>
  <li><a href="#hmc-transition-kernel" id="toc-hmc-transition-kernel" class="nav-link" data-scroll-target="#hmc-transition-kernel">1.2 HMC Transition Kernel</a></li>
  </ul></li>
  <li><a href="#langevin-dynamics-and-mala" id="toc-langevin-dynamics-and-mala" class="nav-link" data-scroll-target="#langevin-dynamics-and-mala">2. Langevin Dynamics and MALA</a>
  <ul class="collapse">
  <li><a href="#overdamped-langevin-diffusion" id="toc-overdamped-langevin-diffusion" class="nav-link" data-scroll-target="#overdamped-langevin-diffusion">2.1 Overdamped Langevin Diffusion</a></li>
  <li><a href="#unadjusted-langevin-algorithm-ula" id="toc-unadjusted-langevin-algorithm-ula" class="nav-link" data-scroll-target="#unadjusted-langevin-algorithm-ula">2.2 Unadjusted Langevin Algorithm (ULA)</a></li>
  <li><a href="#metropolis-adjusted-langevin-algorithm-mala" id="toc-metropolis-adjusted-langevin-algorithm-mala" class="nav-link" data-scroll-target="#metropolis-adjusted-langevin-algorithm-mala">2.3 Metropolis-Adjusted Langevin Algorithm (MALA)</a></li>
  </ul></li>
  <li><a href="#nuts-and-adaptive-path-length" id="toc-nuts-and-adaptive-path-length" class="nav-link" data-scroll-target="#nuts-and-adaptive-path-length">3. NUTS and Adaptive Path Length</a></li>
  <li><a href="#slice-sampling" id="toc-slice-sampling" class="nav-link" data-scroll-target="#slice-sampling">4. Slice Sampling</a>
  <ul class="collapse">
  <li><a href="#basic-idea" id="toc-basic-idea" class="nav-link" data-scroll-target="#basic-idea">4.1 Basic Idea</a></li>
  <li><a href="#practical-implementations" id="toc-practical-implementations" class="nav-link" data-scroll-target="#practical-implementations">4.2 Practical Implementations</a></li>
  </ul></li>
  <li><a href="#adaptive-mcmc" id="toc-adaptive-mcmc" class="nav-link" data-scroll-target="#adaptive-mcmc">5. Adaptive MCMC</a>
  <ul class="collapse">
  <li><a href="#time-inhomogeneous-chains" id="toc-time-inhomogeneous-chains" class="nav-link" data-scroll-target="#time-inhomogeneous-chains">5.1 Time-Inhomogeneous Chains</a></li>
  <li><a href="#diminishing-adaptation-and-containment" id="toc-diminishing-adaptation-and-containment" class="nav-link" data-scroll-target="#diminishing-adaptation-and-containment">5.2 Diminishing Adaptation and Containment</a></li>
  <li><a href="#thm-adaptive-mcmc" id="toc-thm-adaptive-mcmc" class="nav-link" data-scroll-target="#thm-adaptive-mcmc">Theorem 8.2 (Convergence of Adaptive MCMC, Informal)</a></li>
  </ul></li>
  <li><a href="#problem-set-8-representative-problems" id="toc-problem-set-8-representative-problems" class="nav-link" data-scroll-target="#problem-set-8-representative-problems">6. Problem Set 8 (Representative Problems)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modules/module01-foundations.html">Modules</a></li><li class="breadcrumb-item"><a href="../modules/module08-advanced-mcmc.html">Module 8: Advanced MCMC Methods</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Module 8: Advanced MCMC Methods</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="module-8-advanced-mcmc-methods" class="level1">
<h1>Module 8: Advanced MCMC Methods</h1>
<p>This module introduces advanced MCMC algorithms: Hamiltonian Monte Carlo (HMC), Langevin dynamics (MALA), the No-U-Turn Sampler (NUTS), slice sampling, and adaptive MCMC. We emphasize the measure-theoretic foundations of their invariance properties and discuss theoretical guarantees and limitations.</p>
<section id="hamiltonian-monte-carlo-hmc" class="level2">
<h2 class="anchored" data-anchor-id="hamiltonian-monte-carlo-hmc">1. Hamiltonian Monte Carlo (HMC)</h2>
<section id="extended-state-space-and-hamiltonian-dynamics" class="level3">
<h3 class="anchored" data-anchor-id="extended-state-space-and-hamiltonian-dynamics">1.1 Extended State Space and Hamiltonian Dynamics</h3>
<p>Let (^d) denote parameters of interest with target density (()). Introduce auxiliary momentum variables (p ^d) with density (N(0, M)), where (M) is a positive-definite mass matrix.</p>
<p>Define the Hamiltonian <span class="math display">\[
H(\theta, p) = U(\theta) + K(p) = -\log \pi(\theta) + \tfrac12 p^\top M^{-1} p + \text{const}.
\]</span></p>
<p>Hamilton’s equations are <span class="math display">\[
\frac{d\theta}{dt} = \nabla_p H(\theta,p) = M^{-1} p,
\quad
\frac{dp}{dt} = -\nabla_\theta H(\theta,p) = -\nabla U(\theta).
\]</span></p>
</section>
<section id="prop-hmc-volume-energy" class="level3">
<h3 class="anchored" data-anchor-id="prop-hmc-volume-energy">Proposition 8.1 (Volume Preservation and Energy Conservation)</h3>
<p>The exact Hamiltonian flow (_t: (,p) (_t, p_t)) is volume-preserving (Jacobian determinant 1) and conserves (H(,p)).</p>
<p><em>Proof sketch:</em> Hamilton’s equations define a smooth vector field <span class="math display">\[
F(\theta,p) = \begin{pmatrix} M^{-1} p \\ -\nabla U(\theta) \end{pmatrix}
\]</span> on (^{2d}). The associated flow (_t) solves the ODE (_t = F(z_t)) with (z_t = (_t, p_t)). The Jacobian matrix of (F) has zero trace because the position derivatives of the momentum update and the momentum derivatives of the position update cancel; equivalently, the Hamiltonian vector field is divergence-free. Liouville’s theorem then implies that the flow (_t) preserves Lebesgue measure, i.e., it is volume-preserving with determinant 1. Moreover, <span class="math display">\[
\frac{d}{dt} H(\theta_t, p_t)
  = \nabla_\theta H(\theta_t,p_t)^\top \dot{\theta}_t
    + \nabla_p H(\theta_t,p_t)^\top \dot{p}_t
  = \nabla_\theta H^\top M^{-1} p_t - \nabla_p H^\top \nabla U(\theta_t) = 0,
\]</span> by Hamilton’s equations, so (H(_t,p_t)) is conserved along the flow. ()</p>
</section>
<section id="hmc-transition-kernel" class="level3">
<h3 class="anchored" data-anchor-id="hmc-transition-kernel">1.2 HMC Transition Kernel</h3>
<p>A typical HMC iteration:</p>
<ol type="1">
<li>Sample (p N(0, M)) independently of current ().</li>
<li>Approximate Hamiltonian flow for a time (L ) using a symplectic integrator (e.g., leapfrog) to obtain proposal ((‘, p’)).</li>
<li>Accept or reject ((‘, p’)) using an MH step with acceptance probability <span class="math display">\[
\alpha = \min\{1, \exp(-H(\theta',p') + H(\theta,p))\}.
\]</span></li>
<li>Return (’) if accepted, otherwise retain ().</li>
</ol>
<p>The exact flow would preserve the joint density (e^{-H(,p)}); the Metropolis correction accounts for numerical integration error.</p>
</section>
</section>
<section id="langevin-dynamics-and-mala" class="level2">
<h2 class="anchored" data-anchor-id="langevin-dynamics-and-mala">2. Langevin Dynamics and MALA</h2>
<section id="overdamped-langevin-diffusion" class="level3">
<h3 class="anchored" data-anchor-id="overdamped-langevin-diffusion">2.1 Overdamped Langevin Diffusion</h3>
<p>Consider the SDE <span class="math display">\[
d\Theta_t = \frac12 \nabla \log \pi(\Theta_t) \, dt + dB_t,
\]</span> where (B_t) is a standard Brownian motion. Under suitable conditions, () is the invariant distribution of this diffusion.</p>
</section>
<section id="unadjusted-langevin-algorithm-ula" class="level3">
<h3 class="anchored" data-anchor-id="unadjusted-langevin-algorithm-ula">2.2 Unadjusted Langevin Algorithm (ULA)</h3>
<p>Discretize the SDE with step size (&gt; 0): <span class="math display">\[
\Theta_{k+1} = \Theta_k + \frac{\epsilon}{2} \nabla \log \pi(\Theta_k) + \sqrt{\epsilon} Z_k,
\]</span> where (Z_k N(0, I_d)) i.i.d. ULA does not exactly preserve (), but can approximate it under small ().</p>
</section>
<section id="metropolis-adjusted-langevin-algorithm-mala" class="level3">
<h3 class="anchored" data-anchor-id="metropolis-adjusted-langevin-algorithm-mala">2.3 Metropolis-Adjusted Langevin Algorithm (MALA)</h3>
<p>Use the ULA proposal within MH:</p>
<ul>
<li>Proposal density: <span class="math display">\[
q(\theta, \theta') = N\left( \theta + \frac{\epsilon}{2} \nabla \log \pi(\theta),\; \epsilon I_d \right).
\]</span></li>
<li>Acceptance probability as in MH to correct discretization bias.</li>
</ul>
<p>Under regularity conditions, MALA is reversible with invariant distribution ().</p>
</section>
</section>
<section id="nuts-and-adaptive-path-length" class="level2">
<h2 class="anchored" data-anchor-id="nuts-and-adaptive-path-length">3. NUTS and Adaptive Path Length</h2>
<p>The No-U-Turn Sampler (NUTS) adaptively selects trajectory lengths in HMC to avoid wasteful backtracking.</p>
<ul>
<li>Conceptually explores forward and backward along the Hamiltonian trajectory until a “U-turn” criterion is met.</li>
<li>Maintains reversibility and detailed balance through careful construction of a binary tree of candidate states and a symmetric selection rule.</li>
</ul>
<p>Rigorous convergence analyses are more involved but build on the invariance of the joint ((,p)) measure and conditions on step-size adaptation.</p>
</section>
<section id="slice-sampling" class="level2">
<h2 class="anchored" data-anchor-id="slice-sampling">4. Slice Sampling</h2>
<section id="basic-idea" class="level3">
<h3 class="anchored" data-anchor-id="basic-idea">4.1 Basic Idea</h3>
<p>Given target density (()), introduce an auxiliary variable (u (0, ())). The joint density is <span class="math display">\[
f(\theta,u) \propto \mathbf{1}\{0 &lt; u &lt; \pi(\theta)\}.
\]</span></p>
<p>Gibbs sampling in ((,u)) space:</p>
<ol type="1">
<li>Sample (u (0, ())).</li>
<li>Sample (u) uniformly from the “slice” ({: () &gt; u}).</li>
</ol>
<p>The marginal of () is (), making slice sampling an exact MCMC method.</p>
</section>
<section id="practical-implementations" class="level3">
<h3 class="anchored" data-anchor-id="practical-implementations">4.2 Practical Implementations</h3>
<p>Exact sampling from slices is often impossible; one uses interval expansion and shrinking procedures (e.g., stepping-out and shrinkage) that maintain invariance if constructed carefully.</p>
</section>
</section>
<section id="adaptive-mcmc" class="level2">
<h2 class="anchored" data-anchor-id="adaptive-mcmc">5. Adaptive MCMC</h2>
<section id="time-inhomogeneous-chains" class="level3">
<h3 class="anchored" data-anchor-id="time-inhomogeneous-chains">5.1 Time-Inhomogeneous Chains</h3>
<p>Adaptive MCMC updates the transition kernel over time, e.g., adjusting proposal covariance in MH. The resulting chain is no longer Markov with a fixed kernel, complicating convergence analysis.</p>
</section>
<section id="diminishing-adaptation-and-containment" class="level3">
<h3 class="anchored" data-anchor-id="diminishing-adaptation-and-containment">5.2 Diminishing Adaptation and Containment</h3>
<p>A common set of sufficient conditions for convergence to ():</p>
<ol type="1">
<li><strong>Diminishing adaptation:</strong> The difference between successive kernels goes to zero: <span class="math display">\[
\sup_x \| K_{n+1}(x, \cdot) - K_n(x, \cdot) \|_{\text{TV}} \to 0.
\]</span></li>
<li><strong>Containment:</strong> A uniform bound on convergence times across the adaptive sequence.</li>
</ol>
</section>
<section id="thm-adaptive-mcmc" class="level3">
<h3 class="anchored" data-anchor-id="thm-adaptive-mcmc">Theorem 8.2 (Convergence of Adaptive MCMC, Informal)</h3>
<p>If the family of kernels ({K_n}) used in the adaptive algorithm all admit () as invariant distribution, and if diminishing adaptation and a suitable containment condition hold, then the adaptive chain converges to () in distribution.</p>
<p><em>Idea of proof:</em> Write the adaptive chain as using, at iteration (n), a kernel (K_n) chosen based on the past. Diminishing adaptation ensures that successive kernels become close in total variation, so the algorithm behaves asymptotically like a time-homogeneous Markov chain. Containment provides uniform control of convergence times across the family ({K_n}): with high probability, the chain does not spend long periods in regions where convergence is arbitrarily slow. One then constructs a coupling between the adaptive chain and a reference Markov chain with kernel close to (K_n) for large (n), and uses perturbation bounds on Markov operators along with regeneration or drift/minorization techniques to show that the adaptive chain inherits convergence to ().</p>
</section>
</section>
<section id="problem-set-8-representative-problems" class="level2">
<h2 class="anchored" data-anchor-id="problem-set-8-representative-problems">6. Problem Set 8 (Representative Problems)</h2>
<ol type="1">
<li><p><strong>HMC Invariance.</strong> Using Proposition <span class="citation" data-cites="prop-hmc-volume-energy">@prop-hmc-volume-energy</span>, show that the exact Hamiltonian flow preserves the extended density (e^{-H(,p)}). Then argue carefully why the Metropolis correction step yields a Markov chain with invariant distribution (()).</p></li>
<li><p><strong>MALA Detailed Balance.</strong> Derive the MALA acceptance probability and verify detailed balance with respect to () in the general case, making explicit use of the Gaussian proposal density and the MH ratio.</p></li>
<li><p><strong>Slice Sampling Correctness.</strong> Prove that the basic slice sampling scheme with exact slice sampling has () as invariant distribution by viewing it as a Gibbs sampler on the joint density and marginalizing out the auxiliary variable.</p></li>
<li><p><strong>Adaptive MH Example.</strong> Consider an adaptive random-walk MH algorithm that updates the proposal covariance based on the empirical covariance of past samples. Discuss conditions under which diminishing adaptation holds and potential violations of containment, and interpret these conditions in the light of Theorem <strong>?@thm-adaptive-mcmc</strong>.</p></li>
<li><p><strong>HMC Step-Size Tuning.</strong> Discuss how step size and number of leapfrog steps in HMC affect acceptance rates, energy error, and effective exploration, relating your discussion to the theory of symplectic integrators and to the optimal-scaling result Theorem <strong>?@thm-mh-optimal-scaling</strong> from Module 6.</p></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script src="scripts.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>